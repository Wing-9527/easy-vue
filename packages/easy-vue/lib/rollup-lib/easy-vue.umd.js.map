{"version":3,"file":"easy-vue.umd.js","sources":["../../../shared/src/index.ts","../../../reactivity/src/effect.ts","../../../reactivity/src/warning.ts","../../../reactivity/src/baseHandlers.ts","../../../reactivity/src/collectionHandlers.ts","../../../reactivity/src/reactive.ts","../../../reactivity/src/ref.ts","../../../reactivity/src/computed.ts"],"sourcesContent":["export const isObject = (val: unknown): val is Record<any, any> =>\r\n  val !== null && typeof val === 'object'\r\n\r\nexport const isArray = Array.isArray\r\n\r\nexport const extend = Object.assign\r\n\r\nexport const hasChanged = (value: unknown, oldValue: unknown): boolean => !Object.is(value, oldValue)\r\n\r\nexport const NOOP = () => {}\r\n\r\nexport const isFunction = (value: unknown): value is Function => typeof value === 'function'\r\n","import { extend, isArray } from \"@easy-vue/shared\"\r\nimport { ComputedRefImpl } from \"./computed\"\r\n\r\ntype EffectFn = (...args: unknown[]) => unknown\r\n\r\n// interface ReactiveEffectRunner {\r\n//   (): any\r\n//   effect: ReactiveEffect\r\n// }\r\n\r\n/**\r\n * TODO: ReactiveEffect 第二个参数 scheduler 待实现\r\n */\r\nexport class ReactiveEffect {\r\n  public fn: EffectFn\r\n  public deps = []\r\n  public active = true // active 的作用，防止多次调用 cleanupEffect 清除依赖，浪费性能\r\n  public computed?: ComputedRefImpl\r\n  public onStop?: () => unknown\r\n  constructor(fn: EffectFn) {\r\n    this.fn = fn\r\n  }\r\n  public run() {\r\n    activeEffect = this // run的时候，每次更新activeEffect指向\r\n    let res = this.fn()\r\n    // ! 重置\r\n    activeEffect = void 0\r\n    return res\r\n  }\r\n  /**\r\n   * stop 方法，就是将 ReactiveEffect 上对应的副作用函数全部清除\r\n   * runner.effect.stop() -> ReactiveEffectRunner.ReactiveEffect.stop()\r\n   * stop 方法内的 this 为 ReactiveEffect 实例\r\n   */\r\n  public stop() {\r\n    if (this.active) {\r\n      cleanupEffect(this)\r\n      if (this.onStop) {\r\n        this.onStop()\r\n      }\r\n      this.active = false\r\n    }\r\n  }\r\n}\r\n\r\n// /**\r\n//  * TODO: 修复类型报错bug\r\n//  * ? 源码此处：let activeEffect: ReactiveEffect | undefined\r\n//  * ? 我这边按照源码方式初始化，`npm run test` 在 vitest 中测试无法通过，报类型错误\r\n//  * ! 解决方式：必须 new ReactiveEffect(() => {}) 初始化赋值\r\n//  */\r\n// let activeEffect: ReactiveEffect | undefined = new ReactiveEffect(() => {})\r\nlet activeEffect: ReactiveEffect | undefined\r\nlet targetMap = new WeakMap() // 副作用映射树\r\n\r\n/**\r\n * ? 源码为什么不直接返回 ReactiveEffect 实例对象\r\n * ? 猜测1：方便能从 targetMap 映射树中删除对应的 effectFn（相关代码：dep.delete(effect) ）\r\n * ? 猜测2：方便 stop 停止后能再次触发响应式？\r\n */\r\nexport function effect(fn: EffectFn, options?: object) {\r\n  let _effect = new ReactiveEffect(fn)\r\n  extend(_effect, options)\r\n  _effect.run()\r\n  let runner = _effect.fn.bind(_effect)\r\n  // @ts-ignore TODO: ts类型报错\r\n  runner.effect = _effect\r\n  return runner\r\n}\r\n\r\n// track dependencies\r\nexport function track(target: any, key: string | symbol | number) {\r\n  if (activeEffect) {\r\n    let depsMap = targetMap.get(target)\r\n    if (!depsMap) {\r\n      targetMap.set(target, (depsMap = new Map()))\r\n    }\r\n    let dep = depsMap.get(key)\r\n    if (!dep) {\r\n      depsMap.set(key, (dep = new Set()))\r\n    }\r\n    trackEffects(dep)\r\n  }\r\n}\r\n\r\n// trigger\r\nexport function trigger(target: any, key: string | symbol | number) {\r\n  let depsMap = targetMap.get(target)\r\n  if (depsMap?.size) { // fix: vitest属性报错\r\n    let dep = depsMap.get(key)\r\n    triggerEffects(dep)\r\n  }\r\n}\r\n\r\nexport function stop(runner: any) {\r\n  runner.effect.stop()\r\n}\r\n\r\nexport function trackEffects(dep: any) {\r\n  // console.log('activeEffect', activeEffect)\r\n  // debugger\r\n  if (activeEffect) {\r\n    dep.add(activeEffect)\r\n    // @ts-ignore TODO: ts类型报错\r\n    activeEffect!.deps.push(dep)\r\n  }\r\n}\r\n\r\nexport function triggerEffects(dep: any) {\r\n  let effects = isArray(dep) ? dep : [...dep]\r\n  effects.forEach((effect: ReactiveEffect) => {\r\n    // if (effect !== activeEffect) { // 防止无限循环\r\n      effect.run()\r\n    // }\r\n  })\r\n}\r\n\r\n// 清除副作用函数\r\nfunction cleanupEffect(effect: ReactiveEffect) {\r\n  // let { deps } = effect\r\n  // if (deps.length) {\r\n  //   deps.forEach((dep: Set<any>) => dep.delete(effect))\r\n  //   deps.length = 0\r\n  // }\r\n  effect.deps.forEach((dep: Set<any>) => {\r\n    dep.delete(effect)\r\n  })\r\n}\r\n","export function warn(msg: string, ...args: any[]) {\r\n  console.warn(`[Vue warn] ${msg}`, ...args)\r\n}\r\n","import { isObject, extend } from \"@easy-vue/shared\"\r\nimport { track, trigger } from \"./effect\"\r\nimport {\r\n  ReactiveFlags,\r\n  reactiveMap,\r\n  shallowReactiveMap,\r\n  readonlyMap,\r\n  shallowReadonlyMap,\r\n  reactive,\r\n  readonly\r\n} from \"./reactive\"\r\nimport { warn } from \"./warning\"\r\n\r\n// 创建getter\r\nfunction createGetter(isReadonly = false, shallow = false) {\r\n  return function get(target: any, key: string | symbol, receiver: object) {\r\n    if (key === ReactiveFlags.IS_REACTIVE) { // 当 key 是 __v_isReactive，则判定为已经是一个响应式对象\r\n      return !isReadonly\r\n    } else if (key === ReactiveFlags.IS_READONLY) { // 当 key 是 __v_isReadonly，则判定为已经是一个只读对象\r\n      return isReadonly\r\n    } else if ( // 当 key 是 __v_raw，判定为已经是一个代理对象。当缓存中有该代理对象时，直接返回原始的被代理对象\r\n      key === ReactiveFlags.RAW &&\r\n      receiver ===\r\n        (isReadonly\r\n          ? shallow\r\n            ? shallowReadonlyMap\r\n            : readonlyMap\r\n          : shallow\r\n            ? shallowReactiveMap\r\n            : reactiveMap\r\n        ).get(target)\r\n    ) {\r\n      return target\r\n    }\r\n    // 获取当前结果\r\n    const res = Reflect.get(target, key, receiver)\r\n\r\n    /**\r\n     * ! 非只读，依赖收集\r\n     */\r\n    if (!isReadonly) {\r\n      track(target, key)\r\n    }\r\n\r\n    /**\r\n     * ! 如果是 shallow 一层，就不需要将深层嵌套转为响应式\r\n     */\r\n    if (shallow) {\r\n      return res\r\n    }\r\n\r\n    /**\r\n     * TODO\r\n     * ! 源码此处有处理ref对象的操作\r\n     */\r\n\r\n    /**\r\n     * TODO\r\n     * ? 如果属性是对象，为什么要对属性再做一次代理\r\n     *    答：猜测，为了递归做依赖收集？\r\n     *    答：待验证：不把 a.b 变成proxy的话，直接修改 a.b.c 无法触发页面更新\r\n     */\r\n    if (isObject(res)) {\r\n      return isReadonly ? readonly(res) : reactive(res)\r\n    }\r\n\r\n    return res\r\n  }\r\n}\r\n\r\n// 创建setter\r\nfunction createSetter() {\r\n  return function set(target: any, key: string | symbol, value: any, receiver: object) {\r\n    // debugger\r\n    // ? let oldValue = target[key]\r\n    let res = Reflect.set(target, key, value, receiver)\r\n    trigger(target, key)\r\n    return res\r\n  }\r\n}\r\n\r\n// ! 缓存变量\r\nconst get = createGetter()\r\nconst set = createSetter()\r\nconst readonlyGet = createGetter(true)\r\nconst shallowReadonlyGet = createGetter(true, true)\r\n\r\nexport const mutableHandlers: ProxyHandler<object> = {\r\n  get,\r\n  set,\r\n  // deleteProperty,\r\n  // has,\r\n  // ownKeys\r\n}\r\n\r\nexport const readonlyHandlers: ProxyHandler<any> = {\r\n  get: readonlyGet,\r\n  set() { // 不允许改变值\r\n    warn('Update failed: target is readonly')\r\n    return true\r\n  }\r\n}\r\n\r\nexport const shallowReadonlyHandlers: ProxyHandler<object> = extend(\r\n  {},\r\n  readonlyHandlers,\r\n  {\r\n    get: shallowReadonlyGet\r\n  }\r\n)\r\n","export const mutableCollectionHandlers: ProxyHandler<any> = {\r\n  // get: /*#__PURE__*/ createInstrumentationGetter(false, false)\r\n}\r\n\r\nexport const readonlyCollectionHandlers: ProxyHandler<any> = {}\r\n\r\nexport const shallowReadonlyCollectionHandlers: ProxyHandler<any> = {}\r\n","import { isObject } from '@easy-vue/shared'\r\nimport {\r\n  mutableHandlers,\r\n  readonlyHandlers,\r\n  shallowReadonlyHandlers\r\n} from './baseHandlers'\r\nimport {\r\n  mutableCollectionHandlers,\r\n  readonlyCollectionHandlers,\r\n  shallowReadonlyCollectionHandlers\r\n} from './collectionHandlers'\r\n\r\n// 缓存\r\nexport const reactiveMap = new WeakMap()\r\nexport const shallowReactiveMap = new WeakMap()\r\nexport const readonlyMap = new WeakMap()\r\nexport const shallowReadonlyMap = new WeakMap()\r\n\r\nexport const enum ReactiveFlags {\r\n  SKIP = '__v_skip', // 跳过，不做响应式处理的数据\r\n  IS_REACTIVE = '__v_isReactive', // 是 reactive 状态\r\n  IS_READONLY = '__v_isReadonly', // 是 readonly 状态\r\n  IS_SHALLOW = '__v_isShallow', // 是 shallow 状态\r\n  RAW = '__v_raw' // 表示proxy 对应的源数据，target 已经是 proxy 对象时会有该属性\r\n}\r\n\r\nfunction createReactiveObject(target: object, isReadonly: boolean, baseHandlers: object, collectionHandlers: object, proxyMap: WeakMap<any, any>) {\r\n  // 非对象类型，直接返回\r\n  if (!isObject(target)) {\r\n    return target\r\n  }\r\n  // 如果缓存中有该代理对象，直接返回\r\n  const existingProxy = proxyMap.get(target)\r\n  if (existingProxy) {\r\n    return existingProxy\r\n  }\r\n  const proxy = new Proxy(\r\n    target,\r\n    baseHandlers\r\n  )\r\n  proxyMap.set(target, proxy)\r\n  return proxy\r\n}\r\n\r\n/**\r\n * api\r\n */\r\nexport function reactive(target: object) {\r\n  return createReactiveObject(\r\n    target,\r\n    false,\r\n    mutableHandlers,\r\n    mutableCollectionHandlers,\r\n    reactiveMap\r\n  )\r\n}\r\n\r\n/**\r\n * api\r\n * @function 只读\r\n */\r\nexport function readonly(target: object) {\r\n  return createReactiveObject(\r\n    target,\r\n    true,\r\n    readonlyHandlers,\r\n    readonlyCollectionHandlers,\r\n    readonlyMap\r\n  )\r\n}\r\n\r\n/**\r\n * api\r\n */\r\nexport function shallowReadonly(target: object) {\r\n  return createReactiveObject(\r\n    target,\r\n    true,\r\n    shallowReadonlyHandlers,\r\n    shallowReadonlyCollectionHandlers,\r\n    shallowReadonlyMap\r\n  )\r\n}\r\n\r\n/** \r\n * @desc utilities\r\n */\r\nexport function isReadonly(value: any): boolean {\r\n  return value && value[ReactiveFlags.IS_READONLY]\r\n}\r\n\r\nexport function isReactive(value: any): boolean {\r\n  if (isReadonly(value)) {\r\n    return value && value[ReactiveFlags.RAW]\r\n  }\r\n  return value && value[ReactiveFlags.IS_REACTIVE]\r\n}\r\n\r\nexport function isProxy(value: any): boolean {\r\n  return isReactive(value) || isReadonly(value)\r\n}\r\n\r\nexport function toRaw(observed: any): any {\r\n  const raw = observed && observed[ReactiveFlags.RAW]\r\n  return raw ? toRaw(raw) : observed\r\n}\r\n\r\nexport function markRaw() {}\r\n\r\n","import { hasChanged } from \"@easy-vue/shared\"\r\nimport { trackEffects, triggerEffects } from \"./effect\"\r\nimport { reactive, toRaw } from \"./reactive\"\r\n\r\ninterface Ref<T = any> {\r\n  value: T\r\n}\r\n\r\ninterface RefBase extends Ref {\r\n  dep?: Set<any>\r\n}\r\n\r\nclass RefImpl {\r\n  public readonly _v_isRef = true\r\n  private _value: any\r\n  private _rawValue: any\r\n  constructor(value: any, public readonly __v_isShallow: boolean) {\r\n    this._rawValue = __v_isShallow ? value : toRaw(value)\r\n    this._value = __v_isShallow ? value : reactive(value)\r\n  }\r\n  get value() {\r\n    // track 收集依赖\r\n    trackRefValue(this)\r\n    return this._value\r\n  }\r\n  set value(newVal) {\r\n    /**\r\n     * trigger 触发依赖\r\n     * ! 相同值不触发set\r\n     */\r\n    if (hasChanged(newVal, this._rawValue)) {   \r\n      this._rawValue = newVal\r\n      this._value = this.__v_isShallow ? newVal : reactive(newVal)\r\n      triggerRefValue(this)\r\n    }\r\n  }\r\n}\r\n\r\nfunction createRef(rawValue: any, shallow: boolean) {\r\n  if (isRef(rawValue)) {\r\n    return rawValue\r\n  }\r\n  return new RefImpl(rawValue, shallow)\r\n}\r\n\r\nexport function ref(value?: unknown)  {\r\n  return createRef(value, false)\r\n}\r\n\r\n// 追踪 Ref.value\r\nexport function trackRefValue(ref: RefBase) {\r\n  ref = toRaw(ref)\r\n  trackEffects(ref.dep || (ref.dep = new Set()))\r\n}\r\n\r\nexport function triggerRefValue(ref: RefBase) {\r\n  ref = toRaw(ref)\r\n  if (ref.dep) triggerEffects(ref.dep) \r\n}\r\n\r\nexport function isRef(r: any): r is Ref {\r\n  return !!(r && r.__v_isRef === true)\r\n}\r\n\r\nexport function unref(ref: unknown) {\r\n  return isRef(ref) ? ref.value : ref\r\n}\r\n","import { NOOP, isFunction } from \"@easy-vue/shared\";\r\nimport { ReactiveFlags } from \"./reactive\";\r\nimport { ReactiveEffect } from \"./effect\";\r\nimport { trackRefValue, triggerRefValue } from \"./ref\";\r\n\r\nexport type ComputedGetter = (...args: unknown[]) => unknown\r\nexport type ComputedSetter = (value: any) => void\r\n\r\nexport interface WritableComputedOptions {\r\n  get: ComputedGetter\r\n  set: ComputedSetter\r\n}\r\n\r\n/**\r\n * 问题1：\r\n *    无法满足 tase-case 2，Computed.value 作为被监听对象 发生变化时，无法触发对应的副作用函数 \r\n *    TODO: 还需对 Computed.value 做处理\r\n *    track ref value\r\n *    trigger ref value\r\n * 问题2：\r\n *    还未对 debugOptions 做处理\r\n *    TODO: debugOptions.onTrack debugOptions.onTrigger\r\n * 问题3：\r\n *    计算属性缓存未实现\r\n *    TODO: _dirty\r\n * 问题4：\r\n *    需要实现 ReactiveEffect 第二个参数 scheduler，配合实现计算属性缓存\r\n *    TODO: ReactiveEffect scheduler\r\n */\r\nexport class ComputedRefImpl {\r\n  public effect: ReactiveEffect\r\n  public readonly [ReactiveFlags.IS_READONLY]: boolean\r\n  public _dirty = true\r\n  public _value: unknown\r\n  constructor(\r\n    getter: ComputedGetter,\r\n    private readonly _setter: ComputedSetter,\r\n    isReadonly: boolean, // ! 当 getterOrOptions 为函数时，或者 getterOrOptions 为对象却没有 setter 时，是只读\r\n    isSSR: boolean\r\n  ) {\r\n    this.effect = new ReactiveEffect(getter)\r\n    // triggerRefValue(this)\r\n    this[ReactiveFlags.IS_READONLY] = isReadonly\r\n    this.effect.active = !isSSR\r\n    this.effect.computed = this\r\n  }\r\n\r\n  get value() {\r\n    // trackRefValue(this)\r\n    // if (this._dirty) {\r\n    //   this._dirty = false\r\n      this._value = this.effect.run()\r\n    // }\r\n    return this._value\r\n  }\r\n\r\n  set value(newValue: any) {\r\n    this._setter(newValue)\r\n  }\r\n}\r\n\r\nexport function computed(\r\n  getterOrOptions: ComputedGetter |WritableComputedOptions,\r\n  debugOptions?: object,\r\n  isSSR = false\r\n) {\r\n  let getter: ComputedGetter\r\n  let setter: ComputedSetter\r\n  if (isFunction(getterOrOptions)) {\r\n    getter = getterOrOptions\r\n    setter = NOOP\r\n  } else {\r\n    getter = getterOrOptions.get\r\n    setter = getterOrOptions.set\r\n  }\r\n  const cRef = new ComputedRefImpl(getter, setter, isFunction(getterOrOptions) || !setter, isSSR)\r\n  // TODO: 此处还应对 debugOptions 参数做处理\r\n  return cRef\r\n}"],"names":[],"mappings":"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"}